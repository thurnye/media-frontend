<div class="id-backdrop" (click)="onBackdropClick($event)">
  <div class="id-dialog">
    <div class="id-header">
      <h2 class="id-title">Invite Member</h2>
      <button class="id-close-btn" (click)="close.emit()" type="button">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
          <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
        </svg>
      </button>
    </div>

    <div class="id-body">
      <label class="id-label" for="email">Email address</label>
      <div class="id-autocomplete">
        <input
          id="email"
          class="id-input"
          type="email"
          placeholder="Enter email address"
          autocomplete="off"
          [ngModel]="email()"
          (ngModelChange)="onEmailInput($event)"
          (blur)="onInputBlur()"
          (focus)="onInputFocus()"
        />

        @if (showDropdown()) {
          <div class="id-suggestions">
            @for (s of suggestions(); track s.userId) {
              <button
                class="id-suggestion"
                type="button"
                (mousedown)="onSelectSuggestion(s)"
              >
                <div class="id-suggestion-avatar">
                  @if (s.avatarUrl) {
                    <img [src]="s.avatarUrl" [alt]="s.firstName" class="id-suggestion-avatar-img" />
                  } @else {
                    <span class="id-suggestion-initials">{{ getInitials(s) }}</span>
                  }
                </div>
                <div class="id-suggestion-info">
                  <span class="id-suggestion-name">{{ s.firstName }} {{ s.lastName }}</span>
                  <span class="id-suggestion-email">{{ s.email }}</span>
                </div>
              </button>
            }
          </div>
        }
      </div>

      <label class="id-label id-label--role" for="role">Role</label>
      <select
        id="role"
        class="id-select"
        [ngModel]="role()"
        (ngModelChange)="role.set($event)"
      >
        <option value="member">Member</option>
        <option value="manager">Manager</option>
        <option value="admin">Admin</option>
      </select>
    </div>

    <div class="id-footer">
      <button class="id-btn id-btn--cancel" (click)="close.emit()" type="button">Cancel</button>
      <button
        class="id-btn id-btn--invite"
        (click)="onInvite()"
        [disabled]="!email().trim() || saving()"
        type="button"
      >
        @if (saving()) {
          Sending...
        } @else {
          Send Invitation
        }
      </button>
    </div>
  </div>
</div>
